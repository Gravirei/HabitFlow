<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HabitFlow â€” Messages</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=Instrument+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,300,0,0" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --ink: #050810;
  --ink-2: #0a0f1c;
  --ink-3: #0f1628;
  --surface: rgba(255,255,255,0.028);
  --surface-2: rgba(255,255,255,0.05);
  --surface-3: rgba(255,255,255,0.08);
  --border: rgba(255,255,255,0.055);
  --border-2: rgba(255,255,255,0.1);
  --teal: #00e5cc;
  --teal-2: #00c4ae;
  --teal-soft: rgba(0,229,204,0.1);
  --teal-glow: rgba(0,229,204,0.18);
  --teal-text: #00e5cc;
  --emerald: #00d68f;
  --text: #eef2ff;
  --text-2: #8892b0;
  --text-3: #3d4a6b;
  --online: #00e676;
  --away: #ffab40;
  --sent-1: #00b8a0;
  --sent-2: #007a6e;
  --gold: #ffd166;
  --amber: #ffab40;
  --rose: #ff4d6d;
  --violet: #9d4edd;
  --font-display: 'Syne', sans-serif;
  --font-body: 'Instrument Sans', sans-serif;
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
}

html, body { height: 100%; overflow: hidden; }

body {
  font-family: var(--font-body);
  background: var(--ink);
  color: var(--text);
  cursor: default;
}

/* â”€â”€â”€ MESH BACKGROUND â”€â”€â”€ */
.mesh {
  position: fixed; inset: 0; pointer-events: none; z-index: 0;
  background:
    radial-gradient(ellipse 60% 50% at 15% 20%, rgba(0,229,204,0.055) 0%, transparent 60%),
    radial-gradient(ellipse 50% 60% at 85% 75%, rgba(157,78,221,0.045) 0%, transparent 60%),
    radial-gradient(ellipse 40% 40% at 50% 50%, rgba(0,214,143,0.02) 0%, transparent 70%);
}

/* â”€â”€â”€ LAYOUT â”€â”€â”€ */
.shell {
  display: flex;
  height: 100vh;
  position: relative;
  z-index: 1;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIDEBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sidebar {
  width: 320px;
  min-width: 320px;
  display: flex;
  flex-direction: column;
  border-right: 1px solid var(--border);
  background: rgba(10,15,28,0.7);
  backdrop-filter: blur(40px);
  -webkit-backdrop-filter: blur(40px);
  overflow: hidden;
}

/* Brand bar */
.brand-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 22px 20px 18px;
}

.brand {
  display: flex; align-items: center; gap: 10px;
}

.brand-icon {
  width: 34px; height: 34px;
  border-radius: 10px;
  background: linear-gradient(135deg, var(--teal), var(--emerald));
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 0 20px rgba(0,229,204,0.3);
}
.brand-icon .material-symbols-rounded {
  font-size: 18px; color: var(--ink);
  font-variation-settings: 'FILL' 1, 'wght' 600;
}

.brand-name {
  font-family: var(--font-display);
  font-size: 17px;
  font-weight: 800;
  letter-spacing: -0.02em;
  color: var(--text);
}
.brand-name span { color: var(--teal); }

.compose-btn {
  width: 32px; height: 32px;
  border-radius: 9px;
  border: 1px solid var(--border-2);
  background: var(--surface);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  transition: all 0.2s var(--ease-out);
  position: relative;
}
.compose-btn:hover { background: var(--surface-2); border-color: rgba(0,229,204,0.3); transform: scale(1.05); }
.compose-btn .material-symbols-rounded { font-size: 16px; color: var(--text-2); }
.compose-btn:hover .material-symbols-rounded { color: var(--teal); }

.notif-dot {
  position: absolute; top: -3px; right: -3px;
  width: 8px; height: 8px;
  background: var(--rose);
  border-radius: 50%;
  border: 2px solid var(--ink-2);
  animation: pulse-dot 2s ease infinite;
}
@keyframes pulse-dot {
  0%,100% { box-shadow: 0 0 0 0 rgba(255,77,109,0.4); }
  50% { box-shadow: 0 0 0 4px rgba(255,77,109,0); }
}

/* Search */
.search-wrap {
  padding: 0 16px 14px;
}
.search {
  display: flex; align-items: center; gap: 8px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 10px 14px;
  transition: all 0.25s var(--ease-out);
}
.search:focus-within {
  background: rgba(0,229,204,0.05);
  border-color: rgba(0,229,204,0.25);
  box-shadow: 0 0 0 4px rgba(0,229,204,0.06), inset 0 1px 0 rgba(255,255,255,0.04);
}
.search .material-symbols-rounded { font-size: 16px; color: var(--text-3); transition: color 0.2s; }
.search:focus-within .material-symbols-rounded { color: var(--teal); }
.search input {
  background: none; border: none; outline: none;
  font-family: var(--font-body); font-size: 13px;
  color: var(--text); width: 100%;
}
.search input::placeholder { color: var(--text-3); }

/* Filters */
.filters {
  display: flex; gap: 6px;
  padding: 0 16px 14px;
  overflow-x: auto;
}
.filters::-webkit-scrollbar { display: none; }

.filter {
  padding: 5px 13px;
  border-radius: 99px;
  font-family: var(--font-display);
  font-size: 11px; font-weight: 600;
  letter-spacing: 0.02em;
  white-space: nowrap;
  cursor: pointer;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text-3);
  transition: all 0.2s var(--ease-out);
}
.filter:hover { color: var(--text-2); border-color: var(--border-2); }
.filter.on {
  background: var(--teal-soft);
  border-color: rgba(0,229,204,0.3);
  color: var(--teal);
  box-shadow: 0 2px 12px rgba(0,229,204,0.12);
}

/* Section label */
.s-label {
  font-family: var(--font-display);
  font-size: 10px; font-weight: 700;
  letter-spacing: 0.12em; text-transform: uppercase;
  color: var(--text-3);
  padding: 8px 20px 6px;
}

/* Conv list */
.conv-list { flex: 1; overflow-y: auto; }
.conv-list::-webkit-scrollbar { width: 2px; }
.conv-list::-webkit-scrollbar-thumb { background: var(--border-2); border-radius: 2px; }

.conv {
  display: flex; align-items: center; gap: 11px;
  padding: 11px 16px;
  cursor: pointer;
  border-radius: 14px;
  margin: 2px 8px;
  transition: all 0.18s var(--ease-out);
  position: relative;
}
.conv:hover { background: var(--surface-2); }
.conv.active {
  background: rgba(0,229,204,0.07);
  box-shadow: inset 2px 0 0 var(--teal);
}
.conv.active::before {
  content: '';
  position: absolute; left: 0; top: 15%; bottom: 15%;
  width: 3px;
  background: linear-gradient(180deg, var(--teal), var(--emerald));
  border-radius: 0 3px 3px 0;
  box-shadow: 0 0 10px rgba(0,229,204,0.5);
}

/* Avatar */
.av-wrap { position: relative; flex-shrink: 0; }

.av {
  width: 44px; height: 44px;
  border-radius: 14px;
  display: flex; align-items: center; justify-content: center;
  font-family: var(--font-display);
  font-size: 15px; font-weight: 700;
  flex-shrink: 0;
  border: 1px solid var(--border);
  position: relative;
  overflow: hidden;
}
.av::after {
  content: '';
  position: absolute; inset: 0;
  background: linear-gradient(135deg, rgba(255,255,255,0.08), transparent);
  pointer-events: none;
}

.av-aj { background: linear-gradient(135deg, #003d36, #005a4e); color: var(--teal); }
.av-sc { background: linear-gradient(135deg, #2d0f5e, #4a1a99); color: #c4b5fd; }
.av-ml { background: linear-gradient(135deg, #3d1a00, #6b2f00); color: #fdba74; }
.av-jp { background: linear-gradient(135deg, #003340, #005c73); color: #67e8f9; }
.av-g1 { background: linear-gradient(135deg, #0a1628, #0f2040); }
.av-g2 { background: linear-gradient(135deg, #1a0828, #2d1045); }

.sdot {
  position: absolute; bottom: -1px; right: -1px;
  width: 11px; height: 11px;
  border-radius: 50%;
  border: 2px solid var(--ink-2);
}
.sdot.on { background: var(--online); box-shadow: 0 0 6px rgba(0,230,118,0.6); }
.sdot.aw { background: var(--away); }
.sdot.off { background: var(--text-3); }

/* Group avatar */
.group-av {
  width: 44px; height: 44px;
  position: relative;
}
.g-mini {
  position: absolute;
  width: 26px; height: 26px;
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-family: var(--font-display);
  font-size: 10px; font-weight: 700;
  border: 2px solid var(--ink-2);
}
.g-mini:nth-child(1) { top: 0; left: 0; background: linear-gradient(135deg,#003d5c,#006b9f); color: #7dd3fc; }
.g-mini:nth-child(2) { bottom: 0; right: 0; background: linear-gradient(135deg,#3b0764,#7e22ce); color: #d8b4fe; }

/* Conv info */
.c-info { flex: 1; min-width: 0; }
.c-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 3px; }
.c-name {
  font-family: var(--font-display);
  font-size: 13px; font-weight: 600;
  color: var(--text);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  max-width: 160px;
}
.conv.active .c-name { color: #fff; }
.c-time { font-size: 11px; color: var(--text-3); flex-shrink: 0; margin-left: 6px; }

.c-preview {
  font-size: 12px; color: var(--text-3);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  display: flex; align-items: center; gap: 3px;
}
.c-preview .material-symbols-rounded { font-size: 13px; font-variation-settings: 'FILL' 1; }
.c-preview .check-teal { color: var(--teal); }

.unread {
  background: var(--teal);
  color: var(--ink);
  font-family: var(--font-display);
  font-size: 10px; font-weight: 700;
  min-width: 18px; height: 18px;
  border-radius: 9px;
  display: flex; align-items: center; justify-content: center;
  padding: 0 5px;
  flex-shrink: 0;
  box-shadow: 0 2px 8px rgba(0,229,204,0.35);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CHAT MAIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.chat-main {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  position: relative;
}

/* Chat header */
.chat-hdr {
  display: flex; align-items: center; gap: 14px;
  padding: 16px 28px;
  border-bottom: 1px solid var(--border);
  background: rgba(10,15,28,0.6);
  backdrop-filter: blur(40px);
  -webkit-backdrop-filter: blur(40px);
  position: relative; z-index: 10;
}

.hdr-info { flex: 1; }
.hdr-name {
  font-family: var(--font-display);
  font-size: 16px; font-weight: 700;
  letter-spacing: -0.01em;
  color: var(--text);
}
.hdr-status {
  font-size: 12px; color: var(--online);
  display: flex; align-items: center; gap: 5px;
  margin-top: 2px;
}
.hdr-status-dot {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--online);
  box-shadow: 0 0 6px rgba(0,230,118,0.7);
  animation: status-pulse 2.5s ease infinite;
}
@keyframes status-pulse {
  0%,100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.hdr-actions { display: flex; gap: 6px; }
.hdr-btn {
  width: 36px; height: 36px;
  border-radius: 11px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text-2);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  transition: all 0.2s var(--ease-out);
}
.hdr-btn:hover {
  background: var(--surface-2);
  border-color: var(--border-2);
  color: var(--text);
  transform: translateY(-1px);
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
}
.hdr-btn .material-symbols-rounded { font-size: 18px; }

/* Messages */
.msgs {
  flex: 1;
  overflow-y: auto;
  padding: 28px 28px 20px;
  display: flex;
  flex-direction: column;
  gap: 3px;
}
.msgs::-webkit-scrollbar { width: 3px; }
.msgs::-webkit-scrollbar-track { background: transparent; }
.msgs::-webkit-scrollbar-thumb { background: var(--border-2); border-radius: 2px; }

/* Date sep */
.dsep {
  display: flex; align-items: center; gap: 14px;
  margin: 20px 0 14px;
}
.dsep::before, .dsep::after {
  content: ''; flex: 1; height: 1px;
  background: linear-gradient(90deg, transparent, var(--border-2), transparent);
}
.dsep-text {
  font-family: var(--font-display);
  font-size: 10px; font-weight: 700;
  letter-spacing: 0.1em; text-transform: uppercase;
  color: var(--text-3);
  padding: 4px 12px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 99px;
}

/* Msg row */
.mrow {
  display: flex; align-items: flex-end; gap: 9px;
  animation: fadeUp 0.35s var(--ease-spring) both;
}
@keyframes fadeUp {
  from { opacity: 0; transform: translateY(12px) scale(0.97); }
  to { opacity: 1; transform: none; }
}
.mrow.sent { flex-direction: row-reverse; }
.mrow.sent .m-av { display: none; }
.mrow + .mrow { margin-top: 1px; }
.mrow.gap-above { margin-top: 12px; }

.m-av {
  width: 28px; height: 28px;
  border-radius: 9px;
  display: flex; align-items: center; justify-content: center;
  font-family: var(--font-display);
  font-size: 10px; font-weight: 700;
  flex-shrink: 0;
  border: 1px solid var(--border);
}
.m-av.hidden { opacity: 0; pointer-events: none; }
.m-av.aj { background: linear-gradient(135deg,#003d36,#005a4e); color: var(--teal); }

.m-col { display: flex; flex-direction: column; gap: 2px; max-width: 65%; }
.mrow.sent .m-col { align-items: flex-end; }

.sndr {
  font-family: var(--font-display);
  font-size: 10px; font-weight: 600;
  color: var(--text-3);
  padding: 0 5px;
  margin-bottom: 2px;
  letter-spacing: 0.02em;
}

/* Bubble */
.bbl {
  padding: 11px 15px;
  border-radius: 18px;
  font-size: 13.5px;
  line-height: 1.6;
  position: relative;
  cursor: pointer;
  word-break: break-word;
  transition: filter 0.15s;
}
.bbl:hover { filter: brightness(1.1); }

.bbl.recv {
  background: var(--surface-2);
  border: 1px solid var(--border);
  color: var(--text);
  border-bottom-left-radius: 5px;
}
.bbl.sent {
  background: linear-gradient(135deg, #00b8a0, #007a6e);
  color: #fff;
  border-bottom-right-radius: 5px;
  box-shadow: 0 6px 24px rgba(0,184,160,0.28), inset 0 1px 0 rgba(255,255,255,0.15);
}

.bbl-foot {
  display: flex; align-items: center; gap: 4px;
  justify-content: flex-end;
  margin-top: 5px;
}
.bbl-time { font-size: 10px; color: rgba(255,255,255,0.45); font-family: var(--font-display); }
.bbl.recv .bbl-time { color: var(--text-3); }
.rct-icon {
  font-size: 14px !important;
  font-variation-settings: 'FILL' 1 !important;
  color: var(--teal) !important;
}

/* Reactions */
.rxns { display: flex; flex-wrap: wrap; gap: 4px; padding: 3px 4px 0; }
.rxn {
  display: flex; align-items: center; gap: 3px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 99px;
  padding: 3px 8px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.18s var(--ease-spring);
}
.rxn:hover { transform: scale(1.1); background: var(--surface-2); }
.rxn.mine {
  background: rgba(0,229,204,0.1);
  border-color: rgba(0,229,204,0.3);
  box-shadow: 0 2px 10px rgba(0,229,204,0.12);
}
.rxn-cnt { font-family: var(--font-display); font-size: 11px; font-weight: 600; color: var(--text-2); }
.rxn.mine .rxn-cnt { color: var(--teal); }

/* â”€â”€â”€ SPECIAL CARDS â”€â”€â”€ */
.msg-card {
  border-radius: 18px;
  overflow: hidden;
  border: 1px solid var(--border);
  background: rgba(255,255,255,0.025);
  max-width: 290px;
  cursor: pointer;
  transition: all 0.25s var(--ease-out);
  backdrop-filter: blur(20px);
}
.msg-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.4);
  border-color: var(--border-2);
}

/* Habit card */
.hc-top {
  display: flex; align-items: center; gap: 8px;
  padding: 11px 14px;
  background: linear-gradient(135deg, rgba(0,229,204,0.12), rgba(0,214,143,0.06));
  border-bottom: 1px solid rgba(0,229,204,0.12);
}
.hc-top .material-symbols-rounded {
  font-size: 15px; color: var(--teal);
  font-variation-settings: 'FILL' 1;
}
.hc-lbl {
  font-family: var(--font-display);
  font-size: 10px; font-weight: 700;
  letter-spacing: 0.1em; text-transform: uppercase;
  color: var(--teal);
}

.hc-body { padding: 13px 14px; }
.hc-name { font-family: var(--font-display); font-size: 15px; font-weight: 700; color: var(--text); margin-bottom: 8px; }
.hc-tags { display: flex; flex-wrap: wrap; gap: 6px; }
.hc-tag {
  display: flex; align-items: center; gap: 4px;
  padding: 3px 9px;
  border-radius: 99px;
  font-family: var(--font-display); font-size: 11px; font-weight: 600;
  border: 1px solid var(--border);
  background: var(--surface);
}
.hc-tag .material-symbols-rounded { font-size: 12px; font-variation-settings: 'FILL' 1; }
.hc-tag.fire { color: var(--amber); border-color: rgba(255,171,64,0.2); background: rgba(255,171,64,0.07); }
.hc-tag.xp { color: var(--teal); border-color: rgba(0,229,204,0.2); background: rgba(0,229,204,0.07); }

.card-btns {
  display: flex; gap: 7px;
  padding: 9px 14px 13px;
  border-top: 1px solid var(--border);
}
.cbtn {
  flex: 1; padding: 7px 10px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text-2);
  font-family: var(--font-display);
  font-size: 11px; font-weight: 600;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center; gap: 5px;
  transition: all 0.18s var(--ease-out);
  letter-spacing: 0.02em;
}
.cbtn:hover { background: var(--surface-2); color: var(--text); border-color: var(--border-2); }
.cbtn.primary { background: rgba(0,229,204,0.1); border-color: rgba(0,229,204,0.25); color: var(--teal); }
.cbtn.primary:hover { background: rgba(0,229,204,0.18); }
.cbtn .material-symbols-rounded { font-size: 14px; font-variation-settings: 'FILL' 1; }

/* Badge card */
.bc-top {
  display: flex; align-items: center; gap: 8px;
  padding: 11px 14px;
  background: linear-gradient(135deg, rgba(157,78,221,0.12), rgba(124,58,237,0.06));
  border-bottom: 1px solid rgba(157,78,221,0.12);
}
.bc-top .material-symbols-rounded { font-size: 15px; color: var(--violet); font-variation-settings: 'FILL' 1; }
.bc-lbl { font-family: var(--font-display); font-size: 10px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(--violet); }

.bc-body {
  padding: 18px 14px;
  display: flex; flex-direction: column; align-items: center;
  text-align: center; gap: 8px;
}
.b-icon {
  width: 58px; height: 58px;
  border-radius: 17px;
  background: linear-gradient(135deg, #6d28d9, #a855f7);
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 10px 30px rgba(168,85,247,0.4), inset 0 1px 0 rgba(255,255,255,0.2);
  position: relative; overflow: hidden;
}
.b-icon::before {
  content: '';
  position: absolute; top: -30%; left: -30%;
  width: 60%; height: 160%;
  background: rgba(255,255,255,0.12);
  transform: rotate(20deg) skewX(-10deg);
  animation: sheen 3.5s ease-in-out infinite;
}
@keyframes sheen {
  0%,100% { transform: rotate(20deg) skewX(-10deg) translateX(-100%); }
  50% { transform: rotate(20deg) skewX(-10deg) translateX(300%); }
}
.b-icon .material-symbols-rounded { font-size: 28px; color: #fff; font-variation-settings: 'FILL' 1; }
.b-name { font-family: var(--font-display); font-size: 15px; font-weight: 700; color: var(--text); }
.b-desc { font-size: 12px; color: var(--text-2); }
.b-rarity {
  padding: 3px 10px;
  border-radius: 99px;
  font-family: var(--font-display); font-size: 10px; font-weight: 700;
  letter-spacing: 0.1em; text-transform: uppercase;
  background: rgba(157,78,221,0.1);
  border: 1px solid rgba(157,78,221,0.25);
  color: var(--violet);
}

/* Nudge card */
.nudge-msg {
  display: flex; align-items: center; gap: 11px;
  background: rgba(255,171,64,0.07);
  border: 1px solid rgba(255,171,64,0.18);
  border-radius: 16px;
  padding: 13px 15px;
  max-width: 270px;
  cursor: pointer;
  transition: all 0.2s var(--ease-out);
}
.nudge-msg:hover { background: rgba(255,171,64,0.12); transform: translateY(-1px); }
.nudge-ico {
  width: 38px; height: 38px; border-radius: 11px;
  background: rgba(255,171,64,0.12);
  display: flex; align-items: center; justify-content: center; flex-shrink: 0;
  border: 1px solid rgba(255,171,64,0.2);
}
.nudge-ico .material-symbols-rounded { font-size: 19px; color: var(--amber); font-variation-settings: 'FILL' 1; }
.nudge-title { font-family: var(--font-display); font-size: 13px; font-weight: 700; color: var(--amber); }
.nudge-sub { font-size: 12px; color: var(--text-2); margin-top: 2px; line-height: 1.4; }

/* Typing */
.typing-row { display: flex; align-items: flex-end; gap: 9px; margin-top: 6px; animation: fadeUp 0.3s ease both; }
.typing-bbl {
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: 18px; border-bottom-left-radius: 5px;
  padding: 13px 18px;
  display: flex; gap: 5px; align-items: center;
}
.tdot {
  width: 6px; height: 6px; border-radius: 50%;
  background: var(--text-3);
  animation: tdot 1.4s ease infinite;
}
.tdot:nth-child(2) { animation-delay: 0.2s; }
.tdot:nth-child(3) { animation-delay: 0.4s; }
@keyframes tdot {
  0%,60%,100% { transform: translateY(0); opacity: 0.35; }
  30% { transform: translateY(-6px); opacity: 1; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INPUT AREA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.input-zone {
  padding: 14px 20px 18px;
  border-top: 1px solid var(--border);
  background: rgba(10,15,28,0.7);
  backdrop-filter: blur(40px);
  -webkit-backdrop-filter: blur(40px);
}

/* Share tray */
.s-tray {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  margin-bottom: 12px;
  padding: 10px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 18px;
  animation: trayOpen 0.3s var(--ease-spring) both;
  overflow: hidden;
}
.s-tray.closed { display: none; }
@keyframes trayOpen {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: none; }
}

.t-btn {
  display: flex; flex-direction: column; align-items: center; gap: 6px;
  padding: 12px 8px;
  border-radius: 13px;
  border: 1px solid var(--border);
  background: transparent;
  cursor: pointer;
  transition: all 0.2s var(--ease-spring);
}
.t-btn:hover { background: var(--surface-2); border-color: var(--border-2); transform: translateY(-2px); }
.t-btn .material-symbols-rounded { font-size: 22px; font-variation-settings: 'FILL' 1; }
.t-btn span { font-family: var(--font-display); font-size: 10px; font-weight: 600; color: var(--text-2); text-align: center; line-height: 1.2; letter-spacing: 0.02em; }
.t-btn.hab .material-symbols-rounded { color: var(--teal); }
.t-btn.bad .material-symbols-rounded { color: var(--violet); }
.t-btn.nud .material-symbols-rounded { color: var(--amber); }
.t-btn.hab:hover { border-color: rgba(0,229,204,0.3); }
.t-btn.bad:hover { border-color: rgba(157,78,221,0.3); }
.t-btn.nud:hover { border-color: rgba(255,171,64,0.3); }

/* Input row */
.i-row { display: flex; align-items: flex-end; gap: 10px; }

.i-wrap {
  flex: 1;
  display: flex; align-items: flex-end; gap: 9px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 11px 14px;
  transition: all 0.25s var(--ease-out);
}
.i-wrap:focus-within {
  background: rgba(0,229,204,0.04);
  border-color: rgba(0,229,204,0.3);
  box-shadow: 0 0 0 4px rgba(0,229,204,0.06);
}

.plus-btn {
  color: var(--text-3); cursor: pointer;
  transition: all 0.2s var(--ease-spring);
  flex-shrink: 0;
}
.plus-btn:hover { color: var(--teal); transform: rotate(45deg); }
.plus-btn .material-symbols-rounded { font-size: 20px; font-variation-settings: 'FILL' 1; }

.i-wrap textarea {
  flex: 1; background: none; border: none; outline: none;
  font-family: var(--font-body); font-size: 13.5px; line-height: 1.55;
  color: var(--text); resize: none; max-height: 90px; overflow-y: auto;
}
.i-wrap textarea::placeholder { color: var(--text-3); }
.i-wrap textarea::-webkit-scrollbar { width: 2px; }
.i-wrap textarea::-webkit-scrollbar-thumb { background: var(--border-2); }

.send {
  width: 44px; height: 44px;
  border-radius: 14px;
  border: none;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  transition: all 0.22s var(--ease-spring);
  position: relative;
  overflow: hidden;
}
.send.active {
  background: linear-gradient(135deg, var(--teal), var(--emerald));
  box-shadow: 0 6px 24px rgba(0,229,204,0.35);
}
.send.active:hover { transform: scale(1.08); box-shadow: 0 8px 28px rgba(0,229,204,0.45); }
.send.active:active { transform: scale(0.96); }
.send.idle { background: var(--surface-2); border: 1px solid var(--border); cursor: not-allowed; }
.send .material-symbols-rounded {
  font-size: 19px;
  font-variation-settings: 'FILL' 1;
}
.send.active .material-symbols-rounded { color: var(--ink); }
.send.idle .material-symbols-rounded { color: var(--text-3); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RIGHT PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.rpanel {
  width: 270px; min-width: 270px;
  background: rgba(10,15,28,0.65);
  backdrop-filter: blur(40px);
  -webkit-backdrop-filter: blur(40px);
  border-left: 1px solid var(--border);
  overflow-y: auto;
  display: flex; flex-direction: column;
}
.rpanel::-webkit-scrollbar { width: 2px; }
.rpanel::-webkit-scrollbar-thumb { background: var(--border-2); border-radius: 2px; }

.rp-sec { padding: 22px 20px; border-bottom: 1px solid var(--border); }

.rp-ttl {
  font-family: var(--font-display);
  font-size: 10px; font-weight: 700;
  letter-spacing: 0.12em; text-transform: uppercase;
  color: var(--text-3); margin-bottom: 16px;
}

/* Contact card */
.contact-card { display: flex; flex-direction: column; align-items: center; text-align: center; }

.rp-big-av {
  width: 66px; height: 66px;
  border-radius: 20px;
  background: linear-gradient(135deg, #003d36, #005a4e);
  display: flex; align-items: center; justify-content: center;
  font-family: var(--font-display); font-size: 22px; font-weight: 800;
  color: var(--teal);
  position: relative;
  box-shadow: 0 10px 30px rgba(0,61,54,0.5);
  border: 1px solid rgba(0,229,204,0.15);
  overflow: hidden;
}
.rp-big-av::after {
  content: '';
  position: absolute; inset: 0;
  background: linear-gradient(135deg, rgba(255,255,255,0.1), transparent 60%);
}
.rp-av-glow {
  position: absolute; inset: -3px;
  border-radius: 23px;
  background: linear-gradient(135deg, var(--teal), var(--emerald), var(--violet));
  z-index: -1;
  opacity: 0.5;
}

.rp-name {
  font-family: var(--font-display);
  font-size: 16px; font-weight: 800;
  color: var(--text); margin-top: 12px;
  letter-spacing: -0.02em;
}
.rp-lvl { font-size: 12px; color: var(--teal); margin-top: 3px; font-family: var(--font-display); font-weight: 500; }
.rp-status {
  display: flex; align-items: center; gap: 5px;
  font-size: 11px; color: var(--online); margin-top: 5px;
  font-family: var(--font-display); font-weight: 500;
}
.rp-status::before { content: ''; width: 6px; height: 6px; border-radius: 50%; background: var(--online); display: block; box-shadow: 0 0 5px rgba(0,230,118,0.6); }

.rp-grid {
  display: grid; grid-template-columns: 1fr 1fr;
  gap: 7px; margin-top: 16px; width: 100%;
}
.rp-stat {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 13px;
  padding: 11px 10px;
  text-align: center;
  transition: all 0.2s;
}
.rp-stat:hover { background: var(--surface-2); border-color: var(--border-2); }
.rp-stat-v { font-family: var(--font-display); font-size: 17px; font-weight: 800; }
.rp-stat-l { font-size: 10px; color: var(--text-3); margin-top: 2px; font-family: var(--font-display); font-weight: 500; letter-spacing: 0.04em; text-transform: uppercase; }

/* Streak card */
.streak-c {
  display: flex; align-items: center; gap: 10px;
  background: rgba(255,171,64,0.06);
  border: 1px solid rgba(255,171,64,0.15);
  border-radius: 14px;
  padding: 13px;
  margin-top: 12px;
  transition: all 0.2s;
  cursor: default;
}
.streak-c:hover { background: rgba(255,171,64,0.1); }
.streak-em { font-size: 28px; animation: wiggle 3s ease infinite; }
@keyframes wiggle {
  0%,100%,80% { transform: rotate(0deg); }
  85% { transform: rotate(-10deg); }
  90% { transform: rotate(10deg); }
  95% { transform: rotate(-5deg); }
}
.streak-v { font-family: var(--font-display); font-size: 15px; font-weight: 800; color: var(--amber); }
.streak-l { font-size: 11px; color: var(--text-2); margin-top: 1px; }

/* Nudge panel btn */
.np-btn {
  width: 100%; margin-top: 10px;
  padding: 10px;
  border-radius: 12px;
  background: rgba(0,229,204,0.07);
  border: 1px solid rgba(0,229,204,0.18);
  color: var(--teal);
  font-family: var(--font-display); font-size: 12px; font-weight: 600;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center; gap: 7px;
  transition: all 0.2s var(--ease-out);
  letter-spacing: 0.03em;
}
.np-btn:hover { background: rgba(0,229,204,0.14); box-shadow: 0 4px 16px rgba(0,229,204,0.15); }
.np-btn .material-symbols-rounded { font-size: 16px; font-variation-settings: 'FILL' 1; }

/* Today's habits */
.h-item {
  display: flex; align-items: center; gap: 10px;
  padding: 9px 0;
  border-bottom: 1px solid var(--border);
  transition: all 0.15s;
  cursor: default;
}
.h-item:last-child { border-bottom: none; }
.h-dot {
  width: 34px; height: 34px; border-radius: 10px;
  background: var(--teal-soft);
  border: 1px solid rgba(0,229,204,0.15);
  display: flex; align-items: center; justify-content: center; flex-shrink: 0;
}
.h-dot .material-symbols-rounded { font-size: 16px; color: var(--teal); font-variation-settings: 'FILL' 1; }
.h-dot.pending { background: rgba(255,171,64,0.07); border-color: rgba(255,171,64,0.15); }
.h-dot.pending .material-symbols-rounded { color: var(--amber); }
.h-inf { flex: 1; }
.h-name { font-family: var(--font-display); font-size: 12.5px; font-weight: 600; color: var(--text); }
.h-time { font-size: 11px; color: var(--text-3); margin-top: 1px; }
.h-chk .material-symbols-rounded { font-size: 17px; font-variation-settings: 'FILL' 1; }
.h-chk.done { color: var(--teal); }
.h-chk.todo { color: var(--text-3); }

/* Badges */
.badge-mini-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.bm {
  border-radius: 14px;
  padding: 14px 10px;
  text-align: center;
  cursor: pointer;
  transition: all 0.22s var(--ease-spring);
  border: 1px solid var(--border);
  background: var(--surface);
}
.bm:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.3); }
.bm-icon { font-size: 24px; margin-bottom: 5px; }
.bm-name { font-family: var(--font-display); font-size: 11px; font-weight: 700; }
.bm-rarity { font-size: 9px; color: var(--text-3); margin-top: 2px; font-family: var(--font-display); font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; }

/* â”€â”€â”€ REACTION PICKER â”€â”€â”€ */
.rxn-picker {
  position: fixed;
  background: var(--ink-3);
  border: 1px solid var(--border-2);
  border-radius: 18px;
  padding: 10px 8px;
  display: none;
  gap: 2px;
  z-index: 9999;
  box-shadow: 0 24px 64px rgba(0,0,0,0.6), 0 0 0 1px rgba(255,255,255,0.05);
  animation: popIn 0.22s var(--ease-spring) both;
  backdrop-filter: blur(40px);
}
@keyframes popIn {
  from { opacity: 0; transform: scale(0.8) translateY(10px); }
  to { opacity: 1; transform: none; }
}
.rxn-picker.vis { display: flex; }
.re {
  width: 38px; height: 38px;
  border-radius: 11px;
  display: flex; align-items: center; justify-content: center;
  font-size: 19px;
  cursor: pointer;
  transition: all 0.15s var(--ease-spring);
  background: transparent;
}
.re:hover { background: var(--surface-2); transform: scale(1.25); }

/* â”€â”€â”€ TOAST â”€â”€â”€ */
.toast {
  position: fixed; bottom: 90px;
  left: 50%; transform: translateX(-50%) translateY(16px);
  background: var(--ink-3);
  border: 1px solid var(--border-2);
  border-radius: 14px;
  padding: 11px 18px;
  font-family: var(--font-display); font-size: 13px; font-weight: 500;
  color: var(--text);
  display: flex; align-items: center; gap: 9px;
  z-index: 9998; pointer-events: none; opacity: 0;
  transition: all 0.3s var(--ease-spring);
  box-shadow: 0 16px 48px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.04);
  backdrop-filter: blur(30px);
}
.toast.on { opacity: 1; transform: translateX(-50%) translateY(0); }
.toast .material-symbols-rounded { font-size: 16px; color: var(--teal); font-variation-settings: 'FILL' 1; }

/* â”€â”€â”€ MISC UTILS â”€â”€â”€ */
.material-symbols-rounded {
  font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 24;
}
</style>
</head>
<body>
<div class="mesh"></div>

<div class="shell">

  <!-- â•â•â•â•â•â•â•â• SIDEBAR â•â•â•â•â•â•â•â• -->
  <div class="sidebar">
    <div class="brand-bar">
      <div class="brand">
        <div class="brand-icon">
          <span class="material-symbols-rounded">chat_bubble</span>
        </div>
        <div class="brand-name">Habit<span>Flow</span></div>
      </div>
      <div class="compose-btn" onclick="toast('New conversation', 'edit_square')">
        <span class="material-symbols-rounded">edit_square</span>
        <div class="notif-dot"></div>
      </div>
    </div>

    <div class="search-wrap">
      <div class="search">
        <span class="material-symbols-rounded">search</span>
        <input type="text" placeholder="Search conversationsâ€¦" oninput="filterConvs(this.value)">
      </div>
    </div>

    <div class="filters">
      <div class="filter on" onclick="setFilter(this)">All</div>
      <div class="filter" onclick="setFilter(this)">Direct</div>
      <div class="filter" onclick="setFilter(this)">Groups</div>
      <div class="filter" onclick="setFilter(this)">Unread</div>
    </div>

    <div class="s-label">Pinned</div>

    <div class="conv-list" id="convList">
      <div class="conv active" onclick="switchConv(this,'Alex Johnson','AJ','on','Active now','aj')">
        <div class="av-wrap">
          <div class="av av-aj">AJ</div>
          <div class="sdot on"></div>
        </div>
        <div class="c-info">
          <div class="c-top">
            <div class="c-name">Alex Johnson</div>
            <div class="c-time">2m</div>
          </div>
          <div class="c-preview">
            <span class="material-symbols-rounded check-teal">done_all</span>
            You crushed it today! ğŸ’ª
          </div>
        </div>
        <div class="unread">3</div>
      </div>

      <div class="conv" onclick="switchConv(this,'Habit Squad','HS','group','6 members Â· 3 online','g1')">
        <div class="av-wrap">
          <div class="group-av">
            <div class="g-mini">S</div>
            <div class="g-mini">M</div>
          </div>
        </div>
        <div class="c-info">
          <div class="c-top">
            <div class="c-name">Habit Squad</div>
            <div class="c-time">1h</div>
          </div>
          <div class="c-preview">Sarah: Great streak week everyone!</div>
        </div>
        <div class="unread">1</div>
      </div>

      <div class="s-label">Recent</div>

      <div class="conv" onclick="switchConv(this,'Sarah Chen','SC','on','Active now','sc')">
        <div class="av-wrap">
          <div class="av av-sc">SC</div>
          <div class="sdot on"></div>
        </div>
        <div class="c-info">
          <div class="c-top"><div class="c-name">Sarah Chen</div><div class="c-time">3h</div></div>
          <div class="c-preview">Just unlocked Week Warrior! ğŸ‰</div>
        </div>
      </div>

      <div class="conv" onclick="switchConv(this,'Marcus Lee','ML','aw','Away Â· 2h ago','ml')">
        <div class="av-wrap">
          <div class="av av-ml">ML</div>
          <div class="sdot aw"></div>
        </div>
        <div class="c-info">
          <div class="c-top"><div class="c-name">Marcus Lee</div><div class="c-time">Yesterday</div></div>
          <div class="c-preview">Don't break that streak! ğŸ”¥</div>
        </div>
      </div>

      <div class="conv" onclick="switchConv(this,'Jamie Park','JP','off','Offline','jp')">
        <div class="av-wrap">
          <div class="av av-jp">JP</div>
          <div class="sdot off"></div>
        </div>
        <div class="c-info">
          <div class="c-top"><div class="c-name">Jamie Park</div><div class="c-time">Mon</div></div>
          <div class="c-preview">
            <span class="material-symbols-rounded" style="color:var(--text-3)">done_all</span>
            See you at the top! ğŸ†
          </div>
        </div>
      </div>

      <div class="conv" onclick="switchConv(this,'Morning Risers','MR','group','8 members Â· 5 online','g2')">
        <div class="av-wrap">
          <div class="group-av">
            <div class="g-mini" style="background:linear-gradient(135deg,#14532d,#15803d);color:#86efac">E</div>
            <div class="g-mini" style="background:linear-gradient(135deg,#7c2d12,#c2410c);color:#fdba74">D</div>
          </div>
        </div>
        <div class="c-info">
          <div class="c-top"><div class="c-name">Morning Risers</div><div class="c-time">Tue</div></div>
          <div class="c-preview">Emma: 5AM club, let's go! â˜€ï¸</div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â• CHAT MAIN â•â•â•â•â•â•â•â• -->
  <div class="chat-main">
    <div class="chat-hdr">
      <div class="av-wrap">
        <div class="av av-aj" id="hdrAv" style="width:40px;height:40px;border-radius:13px;font-size:13px">AJ</div>
        <div class="sdot on" id="hdrDot"></div>
      </div>
      <div class="hdr-info">
        <div class="hdr-name" id="hdrName">Alex Johnson</div>
        <div class="hdr-status" id="hdrStatus"><div class="hdr-status-dot"></div>Active now</div>
      </div>
      <div class="hdr-actions">
        <div class="hdr-btn" onclick="toast('Nudge sent to Alex!','notifications_active')">
          <span class="material-symbols-rounded">notifications_active</span>
        </div>
        <div class="hdr-btn" onclick="toast('Voice call coming soon','call')">
          <span class="material-symbols-rounded">call</span>
        </div>
        <div class="hdr-btn" onclick="toast('Contact info','info')">
          <span class="material-symbols-rounded">info</span>
        </div>
      </div>
    </div>

    <!-- Messages -->
    <div class="msgs" id="msgs">

      <div class="dsep"><span class="dsep-text">Today</span></div>

      <!-- recv text -->
      <div class="mrow received gap-above">
        <div class="m-av aj">AJ</div>
        <div class="m-col">
          <div class="bbl recv" oncontextmenu="showRxnPicker(event,this)">
            Hey! Did you finish your morning run? ğŸƒ
          </div>
        </div>
      </div>

      <!-- sent text -->
      <div class="mrow sent gap-above">
        <div class="m-col">
          <div class="bbl sent" oncontextmenu="showRxnPicker(event,this)">
            Just finished â€” 5km in 28 min. Personal best! ğŸ‰
            <div class="bbl-foot">
              <span class="bbl-time">9:14</span>
              <span class="material-symbols-rounded rct-icon">done_all</span>
            </div>
          </div>
          <div class="rxns">
            <div class="rxn mine" onclick="toggleRxn(this)">ğŸ”¥<span class="rxn-cnt">3</span></div>
            <div class="rxn" onclick="toggleRxn(this)">ğŸ’ª<span class="rxn-cnt">2</span></div>
          </div>
        </div>
      </div>

      <!-- habit card recv -->
      <div class="mrow received gap-above">
        <div class="m-av aj">AJ</div>
        <div class="m-col">
          <div class="msg-card" onclick="toast('Habit details','check_circle')">
            <div class="hc-top">
              <span class="material-symbols-rounded">check_circle</span>
              <span class="hc-lbl">Habit Completed</span>
            </div>
            <div class="hc-body">
              <div class="hc-name">ğŸƒ Morning Run</div>
              <div class="hc-tags">
                <div class="hc-tag fire"><span class="material-symbols-rounded">local_fire_department</span>14-day streak</div>
                <div class="hc-tag xp"><span class="material-symbols-rounded">star</span>+10 XP</div>
              </div>
            </div>
            <div class="card-btns">
              <div class="cbtn primary" onclick="event.stopPropagation();toast('Reacted with ğŸ’ª','mood')"><span class="material-symbols-rounded">mood</span>React</div>
              <div class="cbtn" onclick="event.stopPropagation();toast('Nudge sent back!','notifications_active')"><span class="material-symbols-rounded">notifications_active</span>Nudge</div>
            </div>
          </div>
          <div class="rxns" style="margin-top:5px">
            <div class="rxn" onclick="toggleRxn(this)">â­<span class="rxn-cnt">1</span></div>
          </div>
        </div>
      </div>

      <!-- sent text -->
      <div class="mrow sent gap-above">
        <div class="m-col">
          <div class="bbl sent" oncontextmenu="showRxnPicker(event,this)">
            Your streak is insane ğŸ”¥ Keep it going!
            <div class="bbl-foot">
              <span class="bbl-time">9:17</span>
              <span class="material-symbols-rounded rct-icon">done_all</span>
            </div>
          </div>
        </div>
      </div>

      <!-- badge card recv -->
      <div class="mrow received gap-above">
        <div class="m-av aj hidden">AJ</div>
        <div class="m-col">
          <div class="msg-card" onclick="toast('Badge details','military_tech')">
            <div class="bc-top">
              <span class="material-symbols-rounded">military_tech</span>
              <span class="bc-lbl">Badge Unlocked</span>
            </div>
            <div class="bc-body">
              <div class="b-icon"><span class="material-symbols-rounded">calendar_month</span></div>
              <div class="b-name">Week Warrior</div>
              <div class="b-desc">7-day streak achieved</div>
              <div class="b-rarity">Rare</div>
            </div>
            <div class="card-btns">
              <div class="cbtn primary" onclick="event.stopPropagation();toast('Reacted with ğŸ‰','mood')"><span class="material-symbols-rounded">mood</span>React</div>
            </div>
          </div>
        </div>
      </div>

      <!-- nudge -->
      <div class="mrow received gap-above">
        <div class="m-av aj">AJ</div>
        <div class="m-col">
          <div class="nudge-msg" onclick="toast('Nudge received!','notifications_active')">
            <div class="nudge-ico"><span class="material-symbols-rounded">notifications_active</span></div>
            <div>
              <div class="nudge-title">Nudge!</div>
              <div class="nudge-sub">Hey! Don't forget your habits today ğŸ’ª</div>
            </div>
          </div>
        </div>
      </div>

      <!-- sent text -->
      <div class="mrow sent gap-above">
        <div class="m-col">
          <div class="bbl sent" oncontextmenu="showRxnPicker(event,this)">
            Thanks! Just logged meditation too âœ¨
            <div class="bbl-foot">
              <span class="bbl-time">10:42</span>
              <span class="material-symbols-rounded rct-icon">done_all</span>
            </div>
          </div>
        </div>
      </div>

      <!-- recv text group -->
      <div class="mrow received gap-above">
        <div class="m-av aj">AJ</div>
        <div class="m-col">
          <div class="bbl recv" oncontextmenu="showRxnPicker(event,this)">
            We're both on fire this week! ğŸ”¥
          </div>
        </div>
      </div>
      <div class="mrow received">
        <div class="m-av aj hidden">AJ</div>
        <div class="m-col">
          <div class="bbl recv" oncontextmenu="showRxnPicker(event,this)">
            Check the board â€” you're sitting in 3rd place now ğŸ†
          </div>
        </div>
      </div>

      <!-- typing -->
      <div class="typing-row" id="typingRow">
        <div class="m-av aj" style="width:28px;height:28px;border-radius:9px;font-size:10px;font-family:var(--font-display);font-weight:700;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;flex-shrink:0;background:linear-gradient(135deg,#003d36,#005a4e);color:var(--teal)">AJ</div>
        <div class="typing-bbl">
          <div class="tdot"></div>
          <div class="tdot"></div>
          <div class="tdot"></div>
        </div>
      </div>

    </div><!-- /msgs -->

    <!-- Input -->
    <div class="input-zone">
      <div class="s-tray closed" id="sTray">
        <div class="t-btn hab" onclick="sendHabit()">
          <span class="material-symbols-rounded">check_circle</span>
          <span>Share Habit</span>
        </div>
        <div class="t-btn bad" onclick="sendBadge()">
          <span class="material-symbols-rounded">military_tech</span>
          <span>Share Badge</span>
        </div>
        <div class="t-btn nud" onclick="sendNudge()">
          <span class="material-symbols-rounded">notifications_active</span>
          <span>Send Nudge</span>
        </div>
      </div>

      <div class="i-row">
        <div class="i-wrap">
          <div class="plus-btn" onclick="toggleTray()">
            <span class="material-symbols-rounded">add_circle</span>
          </div>
          <textarea id="txtInput" rows="1" placeholder="Message Alexâ€¦" oninput="onInput(this)" onkeydown="onKey(event)"></textarea>
        </div>
        <button class="send idle" id="sendBtn" onclick="sendMsg()">
          <span class="material-symbols-rounded">send</span>
        </button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â• RIGHT PANEL â•â•â•â•â•â•â•â• -->
  <div class="rpanel">
    <div class="rp-sec">
      <div class="rp-ttl">Contact</div>
      <div class="contact-card">
        <div style="position:relative;display:inline-block">
          <div class="rp-av-glow"></div>
          <div class="rp-big-av">AJ</div>
        </div>
        <div class="rp-name">Alex Johnson</div>
        <div class="rp-lvl">âš¡ Level 15 Â· Explorer</div>
        <div class="rp-status">Active now</div>
        <div class="rp-grid">
          <div class="rp-stat">
            <div class="rp-stat-v" style="color:var(--teal)">4,820</div>
            <div class="rp-stat-l">Total XP</div>
          </div>
          <div class="rp-stat">
            <div class="rp-stat-v" style="color:var(--amber)">14</div>
            <div class="rp-stat-l">Streak</div>
          </div>
          <div class="rp-stat">
            <div class="rp-stat-v" style="color:var(--gold)">Gold</div>
            <div class="rp-stat-l">League</div>
          </div>
          <div class="rp-stat">
            <div class="rp-stat-v" style="color:var(--violet)">8</div>
            <div class="rp-stat-l">Badges</div>
          </div>
        </div>
        <div class="streak-c">
          <div class="streak-em">ğŸ”¥</div>
          <div>
            <div class="streak-v">12-day mutual streak</div>
            <div class="streak-l">You & Alex are on fire!</div>
          </div>
        </div>
        <div class="np-btn" onclick="toast('Nudge sent to Alex!','notifications_active')">
          <span class="material-symbols-rounded">notifications_active</span>
          Send Nudge
        </div>
      </div>
    </div>

    <div class="rp-sec">
      <div class="rp-ttl">Today's Habits</div>
      <div class="h-item">
        <div class="h-dot"><span class="material-symbols-rounded">directions_run</span></div>
        <div class="h-inf">
          <div class="h-name">Morning Run</div>
          <div class="h-time">Done Â· 9:05 AM</div>
        </div>
        <div class="h-chk done"><span class="material-symbols-rounded">check_circle</span></div>
      </div>
      <div class="h-item">
        <div class="h-dot"><span class="material-symbols-rounded">self_improvement</span></div>
        <div class="h-inf">
          <div class="h-name">Meditation</div>
          <div class="h-time">Done Â· 7:30 AM</div>
        </div>
        <div class="h-chk done"><span class="material-symbols-rounded">check_circle</span></div>
      </div>
      <div class="h-item">
        <div class="h-dot pending"><span class="material-symbols-rounded">menu_book</span></div>
        <div class="h-inf">
          <div class="h-name">Read 20 mins</div>
          <div class="h-time">Not yet today</div>
        </div>
        <div class="h-chk todo"><span class="material-symbols-rounded">radio_button_unchecked</span></div>
      </div>
    </div>

    <div class="rp-sec" style="border-bottom:none">
      <div class="rp-ttl">Shared Badges</div>
      <div class="badge-mini-grid">
        <div class="bm" style="background:rgba(0,229,204,0.06);border-color:rgba(0,229,204,0.15)" onclick="toast('Week Warrior badge','military_tech')">
          <div class="bm-icon">ğŸ“…</div>
          <div class="bm-name" style="color:var(--teal)">Week Warrior</div>
          <div class="bm-rarity">Rare</div>
        </div>
        <div class="bm" style="background:rgba(255,171,64,0.06);border-color:rgba(255,171,64,0.15)" onclick="toast('Streak Master badge','military_tech')">
          <div class="bm-icon">ğŸ”¥</div>
          <div class="bm-name" style="color:var(--amber)">Streak Master</div>
          <div class="bm-rarity">Epic</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Reaction picker -->
<div class="rxn-picker" id="rxnPicker">
  <div class="re" onclick="addRxn('ğŸ”¥')">ğŸ”¥</div>
  <div class="re" onclick="addRxn('ğŸ’ª')">ğŸ’ª</div>
  <div class="re" onclick="addRxn('ğŸ‘')">ğŸ‘</div>
  <div class="re" onclick="addRxn('â­')">â­</div>
  <div class="re" onclick="addRxn('ğŸ˜„')">ğŸ˜„</div>
  <div class="re" onclick="addRxn('ğŸ¯')">ğŸ¯</div>
  <div class="re" onclick="addRxn('ğŸ™Œ')">ğŸ™Œ</div>
  <div class="re" onclick="addRxn('â¤ï¸')">â¤ï¸</div>
</div>

<!-- Toast -->
<div class="toast" id="toastEl">
  <span class="material-symbols-rounded" id="toastIco">check_circle</span>
  <span id="toastTxt">Done!</span>
</div>

<script>
let activeBbl = null, trayOpen = false, toastTmr = null;

const msgsEl = document.getElementById('msgs');
msgsEl.scrollTop = msgsEl.scrollHeight;

// Hide typing after 4s
setTimeout(() => {
  const tr = document.getElementById('typingRow');
  if (tr) tr.style.opacity = '0', tr.style.transition = 'opacity 0.4s', setTimeout(() => tr.remove(), 400);
}, 4000);

function onInput(el) {
  el.style.height = 'auto';
  el.style.height = Math.min(el.scrollHeight, 90) + 'px';
  const btn = document.getElementById('sendBtn');
  if (el.value.trim()) {
    btn.classList.replace('idle', 'active');
  } else {
    btn.classList.replace('active', 'idle');
  }
}

function onKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMsg(); }
}

function sendMsg() {
  const inp = document.getElementById('txtInput');
  const txt = inp.value.trim();
  if (!txt) return;
  addMsg(txt, 'sent', 'text');
  inp.value = ''; inp.style.height = 'auto';
  document.getElementById('sendBtn').classList.replace('active','idle');
  if (trayOpen) toggleTray();

  // Simulate reply
  setTimeout(() => {
    const tr = makeTyping();
    msgsEl.appendChild(tr);
    msgsEl.scrollTop = msgsEl.scrollHeight;
    setTimeout(() => {
      tr.remove();
      const replies = [
        "That's the energy! ğŸ™Œ Keep it up!",
        "You're unstoppable this week ğŸ”¥",
        "Let's both hit the top 3 by Sunday!",
        "Your XP gains are insane right now â­",
        "Bro your streak is giving me motivation ğŸ’ª"
      ];
      addMsg(replies[Math.floor(Math.random() * replies.length)], 'recv', 'text');
    }, 2200);
  }, 900);
}

function makeTyping() {
  const row = document.createElement('div');
  row.className = 'typing-row';
  row.innerHTML = `
    <div style="width:28px;height:28px;border-radius:9px;font-family:var(--font-display);font-size:10px;font-weight:700;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;flex-shrink:0;background:linear-gradient(135deg,#003d36,#005a4e);color:var(--teal)">${document.getElementById('hdrAv').textContent}</div>
    <div class="typing-bbl"><div class="tdot"></div><div class="tdot"></div><div class="tdot"></div></div>`;
  return row;
}

function addMsg(content, side, type) {
  const row = document.createElement('div');
  row.className = `mrow ${side === 'sent' ? 'sent' : 'received'} gap-above`;

  const avTxt = document.getElementById('hdrAv').textContent;
  const avClass = `av-${avTxt.toLowerCase()}` in document.body.style ? '' : '';

  if (side !== 'sent') {
    const av = document.createElement('div');
    av.style.cssText = 'width:28px;height:28px;border-radius:9px;font-family:var(--font-display);font-size:10px;font-weight:700;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;flex-shrink:0;background:linear-gradient(135deg,#003d36,#005a4e);color:var(--teal)';
    av.textContent = avTxt;
    row.appendChild(av);
  }

  const col = document.createElement('div');
  col.className = 'm-col';
  if (side === 'sent') col.style.alignItems = 'flex-end';

  const bbl = document.createElement('div');
  bbl.className = `bbl ${side === 'sent' ? 'sent' : 'recv'}`;
  bbl.setAttribute('oncontextmenu', 'showRxnPicker(event,this)');

  const now = new Date();
  const t = now.getHours().toString().padStart(2,'0') + ':' + now.getMinutes().toString().padStart(2,'0');

  if (side === 'sent') {
    bbl.innerHTML = `${content}<div class="bbl-foot"><span class="bbl-time">${t}</span><span class="material-symbols-rounded rct-icon" id="ri_${Date.now()}">schedule</span></div>`;
    const id = bbl.querySelector('[id^="ri_"]')?.id;
    if (id) {
      setTimeout(() => { const el = document.getElementById(id); if(el) el.textContent = 'done'; }, 700);
      setTimeout(() => { const el = document.getElementById(id); if(el) { el.textContent = 'done_all'; el.style.fontVariationSettings = "'FILL' 1"; } }, 1600);
    }
  } else {
    bbl.textContent = content;
  }

  col.appendChild(bbl);
  row.appendChild(col);
  msgsEl.appendChild(row);
  msgsEl.scrollTop = msgsEl.scrollHeight;
}

function toggleTray() {
  trayOpen = !trayOpen;
  document.getElementById('sTray').classList.toggle('closed', !trayOpen);
}

function sendHabit() {
  const row = document.createElement('div');
  row.className = 'mrow sent gap-above';
  row.innerHTML = `<div class="m-col" style="align-items:flex-end">
    <div class="msg-card">
      <div class="hc-top"><span class="material-symbols-rounded">check_circle</span><span class="hc-lbl">Habit Completed</span></div>
      <div class="hc-body">
        <div class="hc-name">ğŸ§˜ Meditation</div>
        <div class="hc-tags">
          <div class="hc-tag fire"><span class="material-symbols-rounded">local_fire_department</span>14-day streak</div>
          <div class="hc-tag xp"><span class="material-symbols-rounded">star</span>+10 XP</div>
        </div>
      </div>
    </div></div>`;
  msgsEl.appendChild(row);
  msgsEl.scrollTop = msgsEl.scrollHeight;
  toggleTray();
  toast('Habit card shared!', 'check_circle');
}

function sendBadge() {
  const row = document.createElement('div');
  row.className = 'mrow sent gap-above';
  row.innerHTML = `<div class="m-col" style="align-items:flex-end">
    <div class="msg-card">
      <div class="bc-top"><span class="material-symbols-rounded">military_tech</span><span class="bc-lbl">Badge Unlocked</span></div>
      <div class="bc-body">
        <div class="b-icon"><span class="material-symbols-rounded">local_fire_department</span></div>
        <div class="b-name">Streak Master</div>
        <div class="b-desc">30-day streak achieved</div>
        <div class="b-rarity" style="background:rgba(251,191,36,0.1);border-color:rgba(251,191,36,0.25);color:var(--gold)">Epic</div>
      </div>
    </div></div>`;
  msgsEl.appendChild(row);
  msgsEl.scrollTop = msgsEl.scrollHeight;
  toggleTray();
  toast('Badge card shared!', 'military_tech');
}

function sendNudge() {
  const row = document.createElement('div');
  row.className = 'mrow sent gap-above';
  row.innerHTML = `<div class="m-col" style="align-items:flex-end">
    <div class="nudge-msg">
      <div class="nudge-ico"><span class="material-symbols-rounded">notifications_active</span></div>
      <div>
        <div class="nudge-title">Nudge Sent!</div>
        <div class="nudge-sub">Hey! Don't forget your habits today ğŸ’ª</div>
      </div>
    </div></div>`;
  msgsEl.appendChild(row);
  msgsEl.scrollTop = msgsEl.scrollHeight;
  toggleTray();
  toast('Nudge sent!', 'notifications_active');
}

function showRxnPicker(e, bbl) {
  e.preventDefault();
  activeBbl = bbl;
  const p = document.getElementById('rxnPicker');
  p.classList.add('vis');
  p.style.left = Math.min(e.clientX, window.innerWidth - 330) + 'px';
  p.style.top = (e.clientY - 65) + 'px';
}

function addRxn(emoji) {
  if (!activeBbl) return;
  document.getElementById('rxnPicker').classList.remove('vis');
  const col = activeBbl.parentElement;
  let rxns = col.querySelector('.rxns');
  if (!rxns) { rxns = document.createElement('div'); rxns.className = 'rxns'; col.appendChild(rxns); }
  const existing = Array.from(rxns.querySelectorAll('.rxn')).find(r => r.textContent.includes(emoji));
  if (existing) {
    const c = existing.querySelector('.rxn-cnt');
    c.textContent = parseInt(c.textContent) + 1;
    existing.classList.toggle('mine');
  } else {
    const r = document.createElement('div');
    r.className = 'rxn mine';
    r.innerHTML = `${emoji}<span class="rxn-cnt">1</span>`;
    r.onclick = () => toggleRxn(r);
    rxns.appendChild(r);
  }
  toast(`Reacted with ${emoji}`, 'mood');
}

function toggleRxn(el) {
  el.classList.toggle('mine');
  const c = el.querySelector('.rxn-cnt');
  const n = parseInt(c.textContent);
  c.textContent = el.classList.contains('mine') ? n + 1 : Math.max(0, n - 1);
  if (parseInt(c.textContent) === 0) el.remove();
}

document.addEventListener('click', e => {
  const p = document.getElementById('rxnPicker');
  if (!p.contains(e.target)) p.classList.remove('vis');
});

function setFilter(el) {
  document.querySelectorAll('.filter').forEach(f => f.classList.remove('on'));
  el.classList.add('on');
}

function filterConvs(val) {
  const v = val.toLowerCase();
  document.querySelectorAll('.conv').forEach(c => {
    const name = c.querySelector('.c-name')?.textContent.toLowerCase() || '';
    c.style.display = name.includes(v) ? '' : 'none';
  });
}

function switchConv(el, name, initials, status, statusTxt, avKey) {
  document.querySelectorAll('.conv').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  const badge = el.querySelector('.unread');
  if (badge) badge.remove();

  document.getElementById('hdrName').textContent = name;
  document.getElementById('hdrAv').textContent = initials;

  const dot = document.getElementById('hdrDot');
  dot.className = 'sdot ' + (status === 'on' ? 'on' : status === 'aw' ? 'aw' : 'off');

  const hs = document.getElementById('hdrStatus');
  const color = status === 'on' ? 'var(--online)' : status === 'aw' ? 'var(--away)' : 'var(--text-3)';
  hs.style.color = color;
  hs.innerHTML = status === 'on'
    ? `<div class="hdr-status-dot" style="background:${color}"></div>${statusTxt}`
    : `<span>${statusTxt}</span>`;

  document.getElementById('txtInput').placeholder = `Message ${name}â€¦`;
}

function toast(msg, ico) {
  const el = document.getElementById('toastEl');
  document.getElementById('toastTxt').textContent = msg;
  document.getElementById('toastIco').textContent = ico || 'check_circle';
  el.classList.add('on');
  if (toastTmr) clearTimeout(toastTmr);
  toastTmr = setTimeout(() => el.classList.remove('on'), 2600);
}
</script>
</body>
</html>
